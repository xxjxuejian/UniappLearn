{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"menu\">\r\n\t\t\t <uni-segmented-control :current=\"currentTab\" :values=\"tabArr\" @clickItem=\"onClickItem\" \r\n\t\t\t styleType=\"button\" activeColor=\"#4cd964\">\r\n\t\t\t </uni-segmented-control>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"layout\">\r\n\t\t\t\t<view class=\"box\" v-for=\"(item,index) in pets\" :key=\"item._id\">\r\n\t\t\t\t\t<view class=\"pic\" @click='preview(index)'>\r\n\t\t\t\t\t\t<image  lazy-load :src=\"item.url\" mode=\"widthFix\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"text\">{{item.content}}</view>\r\n\t\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"toolbar\">\r\n\t\t\t<view class=\"item\" @click=\"refresh\">\r\n\t\t\t\t<uni-icons type=\"refreshempty\" size=\"30\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"item\" @click=\"goTop\">\r\n\t\t\t\t<uni-icons type=\"arrow-up\" size=\"30\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\r\n\t\t<view class=\"loading\">\r\n\t\t\t<uni-load-more status=\"loading\"></uni-load-more>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\nimport { computed } from 'vue'\n\n\r\nconst pets = ref([])\r\nconst imageUrls = computed(()=>{\r\n\treturn pets.value.map((item)=>{\r\n\t\treturn item.url\r\n\t})\r\n})\r\nfunction getData(){\r\n\t\t// 开启加载动画\r\n\tuni.showNavigationBarLoading()\r\n\tuni.request({\r\n\t\turl:\"https://tea.qingnian8.com/tools/petShow\",\r\n\t\tdata:{\r\n\t\t\tsize:5,\r\n\t\t\ttype:imgType.value\r\n\t\t},\r\n\t\theader:{\r\n\t\t\t\"access-key\":'xxjgetkey$'\r\n\t\t}\r\n\t}).then((res)=>{\r\n\t\t// 网络请求结果别忘记校验\r\n\t\tconst code = res.data.errCode\r\n\t\t// 针对请求成功的情况\r\n\t\tif(code === 0){\r\n\t\t\tpets.value = [...pets.value,...res.data.data]\r\n\t\t}\r\n\t\t// 针对accesskey出错或过期等问题\r\n\t\telse if(code === 400){\r\n\t\t\t// 给出错误提示\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle:res.data.errMsg,\r\n\t\t\t\ticon:'none'\r\n\t\t\t})\r\n\t\t}\r\n\t})\r\n\t// 针对其它错误情况，比如url写错了\r\n\t.catch((err)=>{\r\n\t\tuni.showToast({\r\n\t\t\ttitle:\"请求出错，请检查后重新请求\",\r\n\t\t\ticon:'none'\r\n\t\t})\r\n\t})\r\n\t// 结束加载动画\r\n\t.finally(()=>{\r\n\t\t// 隐藏顶部加载图标\r\n\t\tuni.hideNavigationBarLoading()\r\n\t\t// 停止下拉刷新动画\r\n\t\tuni.stopPullDownRefresh()\r\n\t})\r\n}\r\n\r\n\r\n// 点击图片预览\r\nconst preview = (index)=>{\r\n\t// console.log(index)\r\n\t// console.log(imageUrls.value)\r\n\tuni.previewImage({\r\n\t\turls:imageUrls.value,\r\n\t\tcurrent:index\r\n\t})\r\n}\r\n\r\n\r\n// 触底加载更多\r\nonReachBottom(()=>{\r\n\t// console.log(\"触底l\")\r\n\tgetData();\r\n\tconsole.log(pets.value)\r\n})\r\n\r\n// 下拉刷新\r\nonPullDownRefresh(()=>{\r\n\tpets.value = []\r\n\tgetData();\r\n})\r\n\r\n// 刷新按钮\r\nconst refresh = ()=>{\r\n\tuni.startPullDownRefresh()\r\n}\r\n\r\n// 返回顶部\r\nconst goTop = ()=>{\r\n\tuni.pageScrollTo({\r\n\t\tscrollTop:0\r\n\t})\r\n}\r\n\r\nconst currentTab = ref(0)\r\nconst clssify = [\r\n\t{key:\"all\",value:\"全部\"},\r\n\t{key:\"cat\",value:\"猫猫\"},\r\n\t{key:\"dog\",value:\"狗狗\"}\r\n]\r\nconst tabArr = computed(()=>{\r\n\treturn clssify.map(item=>item.value)\r\n})\r\nconst imgType = computed(()=>{\r\n\treturn clssify[currentTab.value][\"key\"]\r\n})\r\n\r\nconst onClickItem = (e)=>{\r\n\tcurrentTab.value = e.currentIndex\r\n\tpets.value = []\r\n\tgetData()\r\n}\r\n\r\n\r\ngetData()\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.container{\r\n\t.menu{\r\n\t\t// margin-top: 50rpx;\r\n\t\tpadding: 50rpx 50rpx 0rpx 50rpx;\r\n\t\tposition: sticky;\r\n\t\ttop:0;\r\n\t\tz-index: 10;\r\n\t}\r\n\t.layout{\r\n\t\tpadding: 50rpx;\r\n\t\t.box{\r\n\t\t\tbox-shadow: 0 10rpx 40rpx rgba(0,0,0,0.08);\r\n\t\t\tmargin-bottom: 60rpx;\r\n\t\t\tborder-radius: 15rpx;\r\n\t\t\toverflow: hidden;\r\n\t\t\t.pic{\r\n\t\t\t\timage{\r\n\t\t\t\t\tdisplay: inline-block;\r\n\t\t\t\t\tvertical-align: middle;\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.text{\r\n\t\t\t\tpadding :30rpx 0;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.toolbar{\r\n\t\tposition: fixed;\r\n\t\tright: 30rpx;\r\n\t\tbottom: 80rpx;\r\n\t\tpadding-bottom: env(safe-area-inset-bottom);\r\n\t\t.item{\r\n\t\t\twidth: 90rpx;\r\n\t\t\theight: 90rpx;\r\n\t\t\tbackground: rgba(255,255,255,0.9);\r\n\t\t\tborder-radius: 50%;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\tborder: 1px solid #eee;\r\n\t\t}\r\n\t}\r\n\t\r\n\t.loading{\r\n\t\tpadding-bottom: calc(env(safe-area-inset-bottom) + 30rpx);\r\n\t}\r\n\r\n}\r\n\r\n</style>\n","import MiniProgramPage from 'C:/Users/admin/Desktop/xxj/Uniapp学习/petCase/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","computed","uni","onReachBottom","onPullDownRefresh"],"mappings":";;;;;;;;;;;;;;;;;AAoCA,UAAM,OAAOA,cAAG,IAAC,EAAE;AACnB,UAAM,YAAYC,cAAQ,SAAC,MAAI;AAC9B,aAAO,KAAK,MAAM,IAAI,CAAC,SAAO;AAC7B,eAAO,KAAK;AAAA,MACd,CAAE;AAAA,IACF,CAAC;AACD,aAAS,UAAS;AAEjBC,oBAAAA,MAAI,yBAA0B;AAC9BA,oBAAAA,MAAI,QAAQ;AAAA,QACX,KAAI;AAAA,QACJ,MAAK;AAAA,UACJ,MAAK;AAAA,UACL,MAAK,QAAQ;AAAA,QACb;AAAA,QACD,QAAO;AAAA,UACN,cAAa;AAAA,QACb;AAAA,MACH,CAAE,EAAE,KAAK,CAAC,QAAM;AAEd,cAAM,OAAO,IAAI,KAAK;AAEtB,YAAG,SAAS,GAAE;AACb,eAAK,QAAQ,CAAC,GAAG,KAAK,OAAM,GAAG,IAAI,KAAK,IAAI;AAAA,QAC5C,WAEO,SAAS,KAAI;AAEpBA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAM,IAAI,KAAK;AAAA,YACf,MAAK;AAAA,UACT,CAAI;AAAA,QACD;AAAA,MACH,CAAE,EAEA,MAAM,CAAC,QAAM;AACbA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAM;AAAA,UACN,MAAK;AAAA,QACR,CAAG;AAAA,MACH,CAAE,EAEA,QAAQ,MAAI;AAEZA,sBAAAA,MAAI,yBAA0B;AAE9BA,sBAAAA,MAAI,oBAAqB;AAAA,MAC3B,CAAE;AAAA,IACF;AAIA,UAAM,UAAU,CAAC,UAAQ;AAGxBA,oBAAAA,MAAI,aAAa;AAAA,QAChB,MAAK,UAAU;AAAA,QACf,SAAQ;AAAA,MACV,CAAE;AAAA,IACF;AAIAC,kBAAAA,cAAc,MAAI;AAEjB;AACAD,oBAAAA,MAAY,MAAA,OAAA,gCAAA,KAAK,KAAK;AAAA,IACvB,CAAC;AAGDE,kBAAAA,kBAAkB,MAAI;AACrB,WAAK,QAAQ,CAAE;AACf;IACD,CAAC;AAGD,UAAM,UAAU,MAAI;AACnBF,oBAAAA,MAAI,qBAAsB;AAAA,IAC3B;AAGA,UAAM,QAAQ,MAAI;AACjBA,oBAAAA,MAAI,aAAa;AAAA,QAChB,WAAU;AAAA,MACZ,CAAE;AAAA,IACF;AAEA,UAAM,aAAaF,cAAG,IAAC,CAAC;AACxB,UAAM,UAAU;AAAA,MACf,EAAC,KAAI,OAAM,OAAM,KAAI;AAAA,MACrB,EAAC,KAAI,OAAM,OAAM,KAAI;AAAA,MACrB,EAAC,KAAI,OAAM,OAAM,KAAI;AAAA,IACtB;AACA,UAAM,SAASC,cAAQ,SAAC,MAAI;AAC3B,aAAO,QAAQ,IAAI,UAAM,KAAK,KAAK;AAAA,IACpC,CAAC;AACD,UAAM,UAAUA,cAAQ,SAAC,MAAI;AAC5B,aAAO,QAAQ,WAAW,KAAK,EAAE,KAAK;AAAA,IACvC,CAAC;AAED,UAAM,cAAc,CAAC,MAAI;AACxB,iBAAW,QAAQ,EAAE;AACrB,WAAK,QAAQ,CAAE;AACf,cAAS;AAAA,IACV;AAGA,YAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9IT,GAAG,WAAW,eAAe;"}